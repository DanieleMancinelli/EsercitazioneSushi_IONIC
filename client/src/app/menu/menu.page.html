<ion-header>
  <ion-toolbar color="danger">
    <ion-title>Tavolo {{ table }} - {{ user }}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="refreshStatus()"><ion-icon name="refresh"></ion-icon></ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- I MIEI ORDINI (Stato comanda) -->
  <ion-list *ngIf="userOrders.length > 0">
    <ion-list-header><ion-label>I tuoi ordini inviati</ion-label></ion-list-header>
    <ion-item *ngFor="let o of userOrders">
      <ion-label>Ordine #{{ o.id }}</ion-label>
      <ion-badge [color]="o.status === 'IN_ATTESA' ? 'warning' : 'success'">{{ o.status }}</ion-badge>
    </ion-item>
  </ion-list>

  <!-- IL MENU -->
  <div *ngFor="let cat of categories">
    <ion-list-header><ion-label color="danger">{{ cat.name }}</ion-label></ion-list-header>
    <ion-card *ngFor="let p of getProductsByCategory(cat.id)">
      <img [src]="p.image_url" style="height: 150px; width: 100%; object-fit: cover;" />
      <ion-card-header>
        <ion-card-title>{{ p.name }}</ion-card-title>
        <ion-card-subtitle>{{ p.price | currency:'EUR' }}</ion-card-subtitle>
      </ion-card-header>
      <ion-button fill="clear" (click)="addToCart(p)">+ Aggiungi</ion-button>
    </ion-card>
  </div>
</ion-content>

<!-- FOOTER CON CARRELLO -->
<ion-footer *ngIf="cart.length > 0">
  <ion-toolbar color="dark">
    <ion-title size="small">Carrello: {{ cart.length }} piatti</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="sendOrder()" color="success" fill="solid">INVIA ORDINE</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-footer>